let t,n,e=0,r=!1,i=!1,o=!1,s=!1;const c=window,a=document,u={t:0,i:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,n,e,r)=>t.addEventListener(n,e,r),rel:(t,n,e,r)=>t.removeEventListener(n,e,r)},f=(()=>{try{return new CSSStyleSheet,!0}catch(t){}return!1})(),l=new WeakMap,d=t=>l.get(t),h=(t,n)=>l.set(n.o=t,n),p=(t,n)=>n in t,m=t=>console.error(t),v=new Map,w=new Map,b=[],g=[],y=[],S=(t,n)=>e=>{t.push(e),r||(r=!0,n&&4&u.t?j(O):u.raf(O))},E=(t,n)=>{let e=0,r=0;for(;e<t.length&&(r=performance.now())<n;)try{t[e++](r)}catch(i){m(i)}e===t.length?t.length=0:0!==e&&t.splice(0,e)},O=()=>{e++,(t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(n){m(n)}t.length=0})(b);const t=2==(6&u.t)?performance.now()+10*Math.ceil(e*(1/22)):1/0;E(g,t),E(y,t),g.length>0&&(y.push(...g),g.length=0),(r=b.length+g.length+y.length>0)?u.raf(O):e=0},j=t=>Promise.resolve().then(t),T=S(g,!0),I={},C=t=>"object"==(t=typeof t)||"function"===t,P=()=>c.CSS&&c.CSS.supports&&c.CSS.supports("color","var(--c)")?Promise.resolve():__sc_import_app("./p-d8631f0b.js").then(()=>{u.s=c.__stencil_cssshim}),k=async()=>{u.s=c.__stencil_cssshim;const t=new RegExp("/app(\\.esm)?\\.js($|\\?|#)"),n=Array.from(a.querySelectorAll("script")).find(n=>t.test(n.src)||"app"===n.getAttribute("data-stencil-namespace")),e=n["data-opts"];{const t=new URL(".",new URL(n.getAttribute("data-resources-url")||n.src,c.location.href));return D(t.href),window.customElements||await __sc_import_app("./p-d0882b30.js"),Object.assign(Object.assign({},e),{resourcesUrl:t.href})}},D=t=>{const n=(()=>`__sc_import_${"app".replace(/\s|-/g,"_")}`)();try{c[n]=new Function("w",`return import(w);//${Math.random()}`)}catch(e){const r=new Map;c[n]=e=>{const i=new URL(e,t).href;let o=r.get(i);if(!o){const t=a.createElement("script");t.type="module",t.src=URL.createObjectURL(new Blob([`import * as m from '${i}'; window.${n}.m = m;`],{type:"application/javascript"})),o=new Promise(e=>{t.onload=()=>{e(c[n].m),t.remove()}}),r.set(i,o),a.head.appendChild(t)}return o}}},x=new WeakMap,M=t=>"sc-"+t,R=(t,n,...e)=>{let r=null,i=null,o=!1,s=!1,c=[];const a=n=>{for(let e=0;e<n.length;e++)r=n[e],Array.isArray(r)?a(r):null!=r&&"boolean"!=typeof r&&((o="function"!=typeof t&&!C(r))&&(r=String(r)),o&&s?c[c.length-1].u+=r:c.push(o?N(null,r):r),s=o)};if(a(e),n){n.name&&(i=n.name);{const t=n.className||n.class;t&&(n.class="object"!=typeof t?t:Object.keys(t).filter(n=>t[n]).join(" "))}}const u=N(t,null);return u.l=n,c.length>0&&(u.h=c),u.p=i,u},N=(t,n)=>({t:0,v:t,u:n,g:null,h:null,l:null,p:null}),A={},_=(t,n,e,r,i,o)=>{if(e===r)return;let s=p(t,n),a=n.toLowerCase();if("class"===n){const n=t.classList,i=L(e),o=L(r);n.remove(...i.filter(t=>t&&!o.includes(t))),n.add(...o.filter(t=>t&&!i.includes(t)))}else if(s||"o"!==n[0]||"n"!==n[1]){const c=C(r);if((s||c&&null!==r)&&!i)try{if(t.tagName.includes("-"))t[n]=r;else{let i=null==r?"":r;"list"===n?s=!1:null!=e&&t[n]==i||(t[n]=i)}}catch(f){}null==r||!1===r?t.removeAttribute(n):(!s||4&o||i)&&!c&&t.setAttribute(n,r=!0===r?"":r)}else n="-"===n[2]?n.slice(3):p(c,a)?a.slice(2):a[2]+n.slice(3),e&&u.rel(t,n,e,!1),r&&u.ael(t,n,r,!1)},$=/\s/,L=t=>t?t.split($):[],U=(t,n,e,r)=>{const i=11===n.g.nodeType&&n.g.host?n.g.host:n.g,o=t&&t.l||I,s=n.l||I;for(r in o)r in s||_(i,r,o[r],void 0,e,n.t);for(r in s)_(i,r,o[r],s[r],e,n.t)},F=(e,r,o)=>{let c,u,f,l=r.h[o],d=0;if(i||(s=!0,"slot"===l.v&&(l.t|=l.h?2:1)),1&l.t)c=l.g=a.createTextNode("");else if(c=l.g=a.createElement(2&l.t?"slot-fb":l.v),U(null,l,!1),l.h)for(d=0;d<l.h.length;++d)(u=F(e,l,d,c))&&c.appendChild(u);return c["s-hn"]=n,3&l.t&&(c["s-sr"]=!0,c["s-cr"]=t,c["s-sn"]=l.p||"",(f=e&&e.h&&e.h[o])&&f.v===l.v&&e.g&&G(e.g,!1)),c},G=(t,e)=>{u.t|=1;const r=t.childNodes;for(let i=r.length-1;i>=0;i--){const t=r[i];t["s-hn"]!==n&&t["s-ol"]&&(B(t).insertBefore(t,W(t)),t["s-ol"].remove(),t["s-ol"]=void 0,s=!0),e&&G(t,e)}u.t&=-2},J=(t,n,e,r,i,o)=>{let s,c=t["s-cr"]&&t["s-cr"].parentNode||t;for(;i<=o;++i)r[i]&&(s=F(null,e,i,t))&&(r[i].g=s,c.insertBefore(s,W(n)))},z=(t,n,e,r,i)=>{for(;n<=e;++n)(r=t[n])&&(o=!0,(i=r.g)["s-ol"]?i["s-ol"].remove():G(i,!0),i.remove())},V=(t,n)=>t.v===n.v&&("slot"!==t.v||t.p===n.p),W=t=>t&&t["s-ol"]||t,B=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,q=(t,n)=>{const e=n.g=t.g,r=t.h,i=n.h;"slot"===n.v||U(t,n,!1),null!==r&&null!==i?((t,n,e,r)=>{let i,o=0,s=0,c=n.length-1,a=n[0],u=n[c],f=r.length-1,l=r[0],d=r[f];for(;o<=c&&s<=f;)null==a?a=n[++o]:null==u?u=n[--c]:null==l?l=r[++s]:null==d?d=r[--f]:V(a,l)?(q(a,l),a=n[++o],l=r[++s]):V(u,d)?(q(u,d),u=n[--c],d=r[--f]):V(a,d)?("slot"!==a.v&&"slot"!==d.v||G(a.g.parentNode,!1),q(a,d),t.insertBefore(a.g,u.g.nextSibling),a=n[++o],d=r[--f]):V(u,l)?("slot"!==a.v&&"slot"!==d.v||G(u.g.parentNode,!1),q(u,l),t.insertBefore(u.g,a.g),u=n[--c],l=r[++s]):(i=F(n&&n[s],e,s,t),l=r[++s],i&&B(a.g).insertBefore(i,W(a.g)));o>c?J(t,null==r[f+1]?null:r[f+1].g,e,r,s,f):s>f&&z(n,o,c)})(e,r,n,i):null!==i?J(e,null,n,i,0,i.length-1):null!==r&&z(r,0,r.length-1)},H=t=>{let n,e,r,i,o,s,c=t.childNodes;for(e=0,r=c.length;e<r;e++)if(1===(n=c[e]).nodeType){if(n["s-sr"])for(o=n["s-sn"],n.hidden=!1,i=0;i<r;i++)if(c[i]["s-hn"]!==n["s-hn"])if(s=c[i].nodeType,""!==o){if(1===s&&o===c[i].getAttribute("slot")){n.hidden=!0;break}}else if(1===s||3===s&&""!==c[i].textContent.trim()){n.hidden=!0;break}H(n)}},K=[],X=t=>{let n,e,r,i,s=t.childNodes,c=s.length,a=0,u=0,f=0;for(c=s.length;a<c;a++){if((n=s[a])["s-sr"]&&(e=n["s-cr"]))for(i=n["s-sn"],u=(r=e.parentNode.childNodes).length-1;u>=0;u--)(e=r[u])["s-cn"]||e["s-nr"]||e["s-hn"]===n["s-hn"]||((3===(f=e.nodeType)||8===f)&&""===i||1===f&&null===e.getAttribute("slot")&&""===i||1===f&&e.getAttribute("slot")===i)&&(K.some(t=>t.S===e)||(o=!0,e["s-sn"]=i,K.push({O:n,S:e})));1===n.nodeType&&X(n)}},Q=(t,n)=>{n&&!t.j&&n["s-p"].push(new Promise(n=>t.j=n))},Y=(t,n,e,r)=>{if(n.t|=16,4&n.t)return void(n.t|=512);const i=n.o,o=()=>Z(t,n,e,i,r);return Q(n,n.T),rt(void 0,()=>T(o))},Z=(e,r,c,f,l)=>{const d=e["s-rc"];l&&((t,n)=>{((t,n)=>{let e=M(n.I),r=w.get(e);if(t=11===t.nodeType?t:a,r)if("string"==typeof r){let n,i=x.get(t=t.head||t);i||x.set(t,i=new Set),i.has(e)||((n=a.createElement("style")).innerHTML=r,t.insertBefore(n,t.querySelector("link")),i&&i.add(e))}else t.adoptedStyleSheets.includes(r)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,r])})(t.getRootNode(),n)})(e,c);try{((e,r,c,f)=>{n=e.tagName;const l=r.C||N(null,null),d=(t=>t&&t.v===A)(f)?f:R(null,null,f);if(c.P&&(d.l=d.l||{},c.P.forEach(([t,n])=>d.l[n]=e[t])),d.v=null,d.t|=4,r.C=d,d.g=l.g=e,t=e["s-cr"],i=!1,s=o=!1,q(l,d),s){X(d.g);for(let t=0;t<K.length;t++){const n=K[t];if(!n.S["s-ol"]){const t=a.createTextNode("");t["s-nr"]=n.S,n.S.parentNode.insertBefore(n.S["s-ol"]=t,n.S)}}u.t|=1;for(let t=0;t<K.length;t++){const n=K[t],e=n.O.parentNode;let r=n.O.nextSibling,i=n.S["s-ol"];for(;i=i.previousSibling;){let t=i["s-nr"];if(t&&t["s-sn"]===n.S["s-sn"]&&e===t.parentNode&&(!(t=t.nextSibling)||!t["s-nr"])){r=t;break}}(!r&&e!==n.S.parentNode||n.S.nextSibling!==r)&&n.S!==r&&e.insertBefore(n.S,r)}u.t&=-2}o&&H(d.g),K.length=0})(e,r,c,f.render())}catch(h){m(h)}r.t&=-17,r.t|=2,d&&(d.forEach(t=>t()),e["s-rc"]=void 0);{const t=e["s-p"],n=()=>tt(e,r,c);0===t.length?n():(Promise.all(t).then(n),r.t|=4,t.length=0)}},tt=(t,n,e)=>{const r=n.o,i=n.T;64&n.t||(n.t|=64,t.classList.add("hydrated"),et(r,"componentDidLoad"),n.k(t),i||nt()),n.D(t),n.j&&(n.j(),n.j=void 0),512&n.t&&j(()=>Y(t,n,e,!1)),n.t&=-517},nt=()=>{a.documentElement.classList.add("hydrated"),u.t|=2},et=(t,n,e)=>{if(t&&t[n])try{return t[n](e)}catch(r){m(r)}},rt=(t,n)=>t&&t.then?t.then(n):n(),it=(t,n,e)=>{if(n.M){t.watchers&&(n.R=t.watchers);const r=Object.entries(n.M),i=t.prototype;if(r.forEach(([t,[r]])=>{31&r||2&e&&32&r?Object.defineProperty(i,t,{get(){return((t,n)=>d(t).N.get(n))(this,t)},set(e){((t,n,e,r)=>{const i=d(this),o=i.A,s=i.N.get(n),c=i.t,a=i.o;if(!((e=((t,n)=>null==t||C(t)?t:4&n?"false"!==t&&(""===t||!!t):2&n?parseFloat(t):1&n?String(t):t)(e,r.M[n][0]))===s||8&c&&void 0!==s)&&(i.N.set(n,e),a)){if(r.R&&128&c){const t=r.R[n];t&&t.forEach(t=>{try{a[t](e,s,n)}catch(r){m(r)}})}2==(18&c)&&Y(o,i,r,!1)}})(0,t,e,n)},configurable:!0,enumerable:!0}):1&e&&64&r&&Object.defineProperty(i,t,{value(...n){const e=d(this);return e._.then(()=>e.o[t](...n))}})}),1&e){const e=new Map;i.attributeChangedCallback=function(t,n,r){u.jmp(()=>{const n=e.get(t);this[n]=(null!==r||"boolean"!=typeof this[n])&&r})},t.observedAttributes=r.filter(([t,n])=>15&n[0]).map(([t,r])=>{const i=r[1]||t;return e.set(i,t),512&r[0]&&n.P.push([t,i]),i})}}return t},ot=(t,n={})=>{const e=[],r=n.exclude||[],i=a.head,o=c.customElements,s=i.querySelector("meta[charset]"),h=a.createElement("style"),p=[];let b,g=!0;Object.assign(u,n),u.i=new URL(n.resourcesUrl||"./",a.baseURI).href,n.syncQueue&&(u.t|=4),t.forEach(t=>t[1].forEach(n=>{const i={t:n[0],I:n[1],M:n[2],$:n[3]};i.M=n[2],i.P=[],i.R={};const s=i.I,c=class extends HTMLElement{constructor(t){super(t),(t=>{const n={t:0,A:t,N:new Map};n._=new Promise(t=>n.D=t),n.L=new Promise(t=>n.k=t),t["s-p"]=[],t["s-rc"]=[],l.set(t,n)})(t=this)}connectedCallback(){b&&(clearTimeout(b),b=null),g?p.push(this):u.jmp(()=>((t,n)=>{if(0==(1&u.t)){const e=()=>{},r=d(t);if(!(1&r.t)){let e;r.t|=1,e||4&n.t&&(t=>{const n=t["s-cr"]=a.createComment("");n["s-cn"]=!0,t.insertBefore(n,t.firstChild)})(t);{let n=t;for(;n=n.parentNode||n.host;)if(n["s-p"]){Q(r,r.T=n);break}}n.M&&Object.entries(n.M).forEach(([n,[e]])=>{if(31&e&&t.hasOwnProperty(n)){const e=t[n];delete t[n],t[n]=e}}),j(()=>(async(t,n,e,r,i)=>{if(0==(32&n.t)){n.t|=32;{if((i=(t=>{const n=t.I.replace(/-/g,"_"),e=t.U,r=v.get(e);return r?r[n]:__sc_import_app(`./${e}.entry.js`).then(t=>(v.set(e,t),t[n]),m)})(e)).then){const t=()=>{};i=await i,t()}i.isProxied||(e.R=i.watchers,it(i,e,2),i.isProxied=!0);const t=()=>{};n.t|=8;try{new i(n)}catch(c){m(c)}n.t&=-9,n.t|=128,t()}const t=M(e.I);if(!w.has(t)&&i.style){const n=()=>{};((t,n,e)=>{let r=w.get(t);f&&e?(r=r||new CSSStyleSheet).replace(n):r=n,w.set(t,r)})(t,i.style,!!(1&e.t)),n()}}const o=n.T,s=()=>Y(t,n,e,!0);o&&o["s-rc"]?o["s-rc"].push(s):s()})(t,r,n))}e()}})(this,i))}disconnectedCallback(){u.jmp(()=>void 0)}"s-hmr"(t){}forceUpdate(){((t,n)=>{{const e=d(t);2==(18&e.t)&&Y(t,e,n,!1)}})(this,i)}componentOnReady(){return d(this).L}};i.U=t[0],r.includes(s)||o.get(s)||(e.push(s),o.define(s,it(c,i,1)))})),h.innerHTML=e+"{visibility:hidden}.hydrated{visibility:inherit}",h.setAttribute("data-styles",""),i.insertBefore(h,s?s.nextSibling:i.firstChild),g=!1,p.length>0?p.forEach(t=>t.connectedCallback()):u.jmp(()=>b=setTimeout(nt,30,"timeout"))},st=(t,n,e)=>{const r=ct(t);return{emit:t=>r.dispatchEvent(new CustomEvent(n,{bubbles:!!(4&e),composed:!!(2&e),cancelable:!!(1&e),detail:t}))}},ct=t=>d(t).A;let at=!0,ut=!0;function ft(t,n,e){const r=t.match(n);return r&&r.length>=e&&parseInt(r[e],10)}function lt(t,n,e){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(t,r){if(t!==n)return i.apply(this,arguments);const o=t=>{const n=e(t);n&&r(n)};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[t,o])};const o=r.removeEventListener;r.removeEventListener=function(t,e){if(t!==n||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);const r=this._eventMap[e];return delete this._eventMap[e],o.apply(this,[t,r])},Object.defineProperty(r,"on"+n,{get(){return this["_on"+n]},set(t){this["_on"+n]&&(this.removeEventListener(n,this["_on"+n]),delete this["_on"+n]),t&&this.addEventListener(n,this["_on"+n]=t)},enumerable:!0,configurable:!0})}function dt(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(at=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function ht(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(ut=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function pt(){if("object"==typeof window){if(at)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function mt(t,n){ut&&console.warn(t+" is deprecated, please use "+n+" instead.")}function vt(t){const{navigator:n}=t,e={browser:null,version:null};if(void 0===t||!t.navigator)return e.browser="Not a browser.",e;if(n.mozGetUserMedia)e.browser="firefox",e.version=ft(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===t.isSecureContext&&t.webkitRTCPeerConnection&&!t.RTCIceGatherer)e.browser="chrome",e.version=ft(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))e.browser="edge",e.version=ft(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!t.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return e.browser="Not a supported browser.",e;e.browser="safari",e.version=ft(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype}return e}function wt(t){return"[object Object]"===Object.prototype.toString.call(t)}function bt(t){return wt(t)?Object.keys(t).reduce((function(n,e){const r=wt(t[e]),i=r?bt(t[e]):t[e],o=r&&!Object.keys(i).length;return void 0===i||o?n:Object.assign(n,{[e]:i})}),{}):t}function gt(t,n,e){const r=e?"outbound-rtp":"inbound-rtp",i=new Map;if(null===n)return i;const o=[];return t.forEach(t=>{"track"===t.type&&t.trackIdentifier===n.id&&o.push(t)}),o.forEach(n=>{t.forEach(e=>{e.type===r&&e.trackId===n.id&&function t(n,e,r){e&&!r.has(e.id)&&(r.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?t(n,n.get(e[i]),r):i.endsWith("Ids")&&e[i].forEach(e=>{t(n,n.get(e),r)})}))}(t,e,i)})}),i}const yt=pt;function St(t){const n=t&&t.navigator;if(!n.mediaDevices)return;const e=vt(t),r=function(t){if("object"!=typeof t||t.mandatory||t.optional)return t;const n={};return Object.keys(t).forEach(e=>{if("require"===e||"advanced"===e||"mediaSource"===e)return;const r="object"==typeof t[e]?t[e]:{ideal:t[e]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const i=function(t,n){return t?t+n.charAt(0).toUpperCase()+n.slice(1):"deviceId"===n?"sourceId":n};if(void 0!==r.ideal){n.optional=n.optional||[];let t={};"number"==typeof r.ideal?(t[i("min",e)]=r.ideal,n.optional.push(t),(t={})[i("max",e)]=r.ideal,n.optional.push(t)):(t[i("",e)]=r.ideal,n.optional.push(t))}void 0!==r.exact&&"number"!=typeof r.exact?(n.mandatory=n.mandatory||{},n.mandatory[i("",e)]=r.exact):["min","max"].forEach(t=>{void 0!==r[t]&&(n.mandatory=n.mandatory||{},n.mandatory[i(t,e)]=r[t])})}),t.advanced&&(n.optional=(n.optional||[]).concat(t.advanced)),n},i=function(t,i){if(e.version>=61)return i(t);if((t=JSON.parse(JSON.stringify(t)))&&"object"==typeof t.audio){const n=function(t,n,e){n in t&&!(e in t)&&(t[e]=t[n],delete t[n])};n((t=JSON.parse(JSON.stringify(t))).audio,"autoGainControl","googAutoGainControl"),n(t.audio,"noiseSuppression","googNoiseSuppression"),t.audio=r(t.audio)}if(t&&"object"==typeof t.video){let o=t.video.facingMode;const s=e.version<66;if((o=o&&("object"==typeof o?o:{ideal:o}))&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||s)){let e;if(delete t.video.facingMode,"environment"===o.exact||"environment"===o.ideal?e=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(e=["front"]),e)return n.mediaDevices.enumerateDevices().then(n=>{let s=(n=n.filter(t=>"videoinput"===t.kind)).find(t=>e.some(n=>t.label.toLowerCase().includes(n)));return!s&&n.length&&e.includes("back")&&(s=n[n.length-1]),s&&(t.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),t.video=r(t.video),yt("chrome: "+JSON.stringify(t)),i(t)})}t.video=r(t.video)}return yt("chrome: "+JSON.stringify(t)),i(t)},o=function(t){return e.version>=64?t:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[t.name]||t.name,message:t.message,constraint:t.constraint||t.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(t,e,r){i(t,t=>{n.webkitGetUserMedia(t,e,t=>{r&&r(o(t))})})}.bind(n),n.mediaDevices.getUserMedia){const t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(n){return i(n,n=>t(n).then(t=>{if(n.audio&&!t.getAudioTracks().length||n.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(t=>{t.stop()}),new DOMException("","NotFoundError");return t},t=>Promise.reject(o(t))))}}}function Et(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function Ot(t){if("object"!=typeof t||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype)lt(t,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t));else{Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",e=>{let r;r=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(t=>t.track&&t.track.id===e.track.id):{track:e.track};const i=new Event("track");i.track=e.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[n.stream],this.dispatchEvent(i)}),n.stream.getTracks().forEach(e=>{let r;r=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(t=>t.track&&t.track.id===e.id):{track:e};const i=new Event("track");i.track=e,i.receiver=r,i.transceiver={receiver:r},i.streams=[n.stream],this.dispatchEvent(i)})},this.addEventListener("addstream",this._ontrackpoly)),n.apply(this,arguments)}}}function jt(t){if("object"==typeof t&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const n=function(t,n){return{track:n,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===n.kind?t.createDTMFSender(n):null),this._dtmf},_pc:t}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,r){let i=e.apply(this,arguments);return i||(i=n(this,t),this._senders.push(i)),i};const r=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){r.apply(this,arguments);const n=this._senders.indexOf(t);-1!==n&&this._senders.splice(n,1)}}const e=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){this._senders=this._senders||[],e.apply(this,[t]),t.getTracks().forEach(t=>{this._senders.push(n(this,t))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){this._senders=this._senders||[],r.apply(this,[t]),t.getTracks().forEach(t=>{const n=this._senders.find(n=>n.track===t);n&&this._senders.splice(this._senders.indexOf(n),1)})}}else if("object"==typeof t&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const t=n.apply(this,[]);return t.forEach(t=>t._pc=this),t},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}}function Tt(t){if(!t.RTCPeerConnection)return;const n=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[t,e,r]=arguments;if(arguments.length>0&&"function"==typeof t)return n.apply(this,arguments);if(0===n.length&&(0===arguments.length||"function"!=typeof t))return n.apply(this,[]);const i=function(t){const n={};return t.result().forEach(t=>{const e={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(n=>{e[n]=t.stat(n)}),n[e.id]=e}),n},o=function(t){return new Map(Object.keys(t).map(n=>[n,t[n]]))};return arguments.length>=2?n.apply(this,[function(t){e(o(i(t)))},t]):new Promise((t,e)=>{n.apply(this,[function(n){t(o(i(n)))},e])}).then(e,r)}}function It(t){if(!("object"==typeof t&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const t=n.apply(this,[]);return t.forEach(t=>t._pc=this),t});const e=t.RTCPeerConnection.prototype.addTrack;e&&(t.RTCPeerConnection.prototype.addTrack=function(){const t=e.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function(){const t=this;return this._pc.getStats().then(n=>gt(n,t.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const t=n.apply(this,[]);return t.forEach(t=>t._pc=this),t}),lt(t,"track",t=>(t.receiver._pc=t.srcElement,t)),t.RTCRtpReceiver.prototype.getStats=function(){const t=this;return this._pc.getStats().then(n=>gt(n,t.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const n=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const t=arguments[0];let n,e,r;return this.getSenders().forEach(e=>{e.track===t&&(n?r=!0:n=e)}),this.getReceivers().forEach(n=>(n.track===t&&(e?r=!0:e=n),n.track===t)),r||n&&e?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():e?e.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return n.apply(this,arguments)}}function Ct(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(t=>this._shimmedLocalStreams[t][0])};const n=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,e){if(!e)return n.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=n.apply(this,arguments);return this._shimmedLocalStreams[e.id]?-1===this._shimmedLocalStreams[e.id].indexOf(r)&&this._shimmedLocalStreams[e.id].push(r):this._shimmedLocalStreams[e.id]=[e,r],r};const e=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){this._shimmedLocalStreams=this._shimmedLocalStreams||{},t.getTracks().forEach(t=>{if(this.getSenders().find(n=>n.track===t))throw new DOMException("Track already exists.","InvalidAccessError")});const n=this.getSenders();e.apply(this,arguments);const r=this.getSenders().filter(t=>-1===n.indexOf(t));this._shimmedLocalStreams[t.id]=[t].concat(r)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[t.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},t&&Object.keys(this._shimmedLocalStreams).forEach(n=>{const e=this._shimmedLocalStreams[n].indexOf(t);-1!==e&&this._shimmedLocalStreams[n].splice(e,1),1===this._shimmedLocalStreams[n].length&&delete this._shimmedLocalStreams[n]}),i.apply(this,arguments)}}function Pt(t){if(!t.RTCPeerConnection)return;const n=vt(t);if(t.RTCPeerConnection.prototype.addTrack&&n.version>=65)return Ct(t);const e=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const t=e.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map(t=>this._reverseStreams[t.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(n){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.getTracks().forEach(t=>{if(this.getSenders().find(n=>n.track===t))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[n.id]){const e=new t.MediaStream(n.getTracks());this._streams[n.id]=e,this._reverseStreams[e.id]=n,n=e}r.apply(this,[n])};const i=t.RTCPeerConnection.prototype.removeStream;function o(t,n){let e=n.sdp;return Object.keys(t._reverseStreams||[]).forEach(n=>{const r=t._reverseStreams[n];e=e.replace(new RegExp(t._streams[r.id].id,"g"),r.id)}),new RTCSessionDescription({type:n.type,sdp:e})}function s(t,n){let e=n.sdp;return Object.keys(t._reverseStreams||[]).forEach(n=>{const r=t._reverseStreams[n],i=t._streams[r.id];e=e.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:n.type,sdp:e})}t.RTCPeerConnection.prototype.removeStream=function(t){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[t.id]||t]),delete this._reverseStreams[this._streams[t.id]?this._streams[t.id].id:t.id],delete this._streams[t.id]},t.RTCPeerConnection.prototype.addTrack=function(n,e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(t=>t===n))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find(t=>t.track===n);if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[e.id];if(o)o.addTrack(n),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const r=new t.MediaStream([n]);this._streams[e.id]=r,this._reverseStreams[r.id]=e,this.addStream(r)}return this.getSenders().find(t=>t.track===n)},["createOffer","createAnswer"].forEach((function(n){const e=t.RTCPeerConnection.prototype[n];t.RTCPeerConnection.prototype[n]={[n](){const t=arguments;return arguments.length&&"function"==typeof arguments[0]?e.apply(this,[n=>{const e=o(this,n);t[0].apply(null,[e])},n=>{t[1]&&t[1].apply(null,n)},arguments[2]]):e.apply(this,arguments).then(t=>o(this,t))}}[n]}));const c=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=s(this,arguments[0]),c.apply(this,arguments)):c.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const t=a.get.apply(this);return""===t.type?t:o(this,t)}}),t.RTCPeerConnection.prototype.removeTrack=function(t){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(t._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let n;this._streams=this._streams||{},Object.keys(this._streams).forEach(e=>{this._streams[e].getTracks().find(n=>t.track===n)&&(n=this._streams[e])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function kt(t){const n=vt(t);if(!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),!t.RTCPeerConnection)return;n.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(n){const e=t.RTCPeerConnection.prototype[n];t.RTCPeerConnection.prototype[n]={[n](){return arguments[0]=new("addIceCandidate"===n?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),e.apply(this,arguments)}}[n]}));const e=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}function Dt(t){lt(t,"negotiationneeded",t=>{if("stable"===t.target.signalingState)return t})}const xt=Object.freeze({__proto__:null,shimMediaStream:Et,shimOnTrack:Ot,shimGetSendersWithDtmf:jt,shimGetStats:Tt,shimSenderReceiverGetStats:It,shimAddTrackRemoveTrackWithNative:Ct,shimAddTrackRemoveTrack:Pt,shimPeerConnection:kt,fixNegotiationNeeded:Dt,shimGetUserMedia:St,shimGetDisplayMedia:function(t,n){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&("function"==typeof n?t.navigator.mediaDevices.getDisplayMedia=function(e){return n(e).then(n=>{const r=e.video&&e.video.width,i=e.video&&e.video.height;return e.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n,maxFrameRate:e.video&&e.video.frameRate||3}},r&&(e.video.mandatory.maxWidth=r),i&&(e.video.mandatory.maxHeight=i),t.navigator.mediaDevices.getUserMedia(e)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});var Mt,Rt=(function(t){var n={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};n.localCName=n.generateIdentifier(),n.splitLines=function(t){return t.trim().split("\n").map((function(t){return t.trim()}))},n.splitSections=function(t){return t.split("\nm=").map((function(t,n){return(n>0?"m="+t:t).trim()+"\r\n"}))},n.getDescription=function(t){var e=n.splitSections(t);return e&&e[0]},n.getMediaSections=function(t){var e=n.splitSections(t);return e.shift(),e},n.matchPrefix=function(t,e){return n.splitLines(t).filter((function(t){return 0===t.indexOf(e)}))},n.parseCandidate=function(t){for(var n,e={foundation:(n=0===t.indexOf("a=candidate:")?t.substring(12).split(" "):t.substring(10).split(" "))[0],component:parseInt(n[1],10),protocol:n[2].toLowerCase(),priority:parseInt(n[3],10),ip:n[4],address:n[4],port:parseInt(n[5],10),type:n[7]},r=8;r<n.length;r+=2)switch(n[r]){case"raddr":e.relatedAddress=n[r+1];break;case"rport":e.relatedPort=parseInt(n[r+1],10);break;case"tcptype":e.tcpType=n[r+1];break;case"ufrag":e.ufrag=n[r+1],e.usernameFragment=n[r+1];break;default:e[n[r]]=n[r+1]}return e},n.writeCandidate=function(t){var n=[];n.push(t.foundation),n.push(t.component),n.push(t.protocol.toUpperCase()),n.push(t.priority),n.push(t.address||t.ip),n.push(t.port);var e=t.type;return n.push("typ"),n.push(e),"host"!==e&&t.relatedAddress&&t.relatedPort&&(n.push("raddr"),n.push(t.relatedAddress),n.push("rport"),n.push(t.relatedPort)),t.tcpType&&"tcp"===t.protocol.toLowerCase()&&(n.push("tcptype"),n.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(n.push("ufrag"),n.push(t.usernameFragment||t.ufrag)),"candidate:"+n.join(" ")},n.parseIceOptions=function(t){return t.substr(14).split(" ")},n.parseRtpMap=function(t){var n=t.substr(9).split(" "),e={payloadType:parseInt(n.shift(),10)};return n=n[0].split("/"),e.name=n[0],e.clockRate=parseInt(n[1],10),e.channels=3===n.length?parseInt(n[2],10):1,e.numChannels=e.channels,e},n.writeRtpMap=function(t){var n=t.payloadType;void 0!==t.preferredPayloadType&&(n=t.preferredPayloadType);var e=t.channels||t.numChannels||1;return"a=rtpmap:"+n+" "+t.name+"/"+t.clockRate+(1!==e?"/"+e:"")+"\r\n"},n.parseExtmap=function(t){var n=t.substr(9).split(" ");return{id:parseInt(n[0],10),direction:n[0].indexOf("/")>0?n[0].split("/")[1]:"sendrecv",uri:n[1]}},n.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&"sendrecv"!==t.direction?"/"+t.direction:"")+" "+t.uri+"\r\n"},n.parseFmtp=function(t){for(var n,e={},r=t.substr(t.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)e[(n=r[i].trim().split("="))[0].trim()]=n[1];return e},n.writeFmtp=function(t){var n="",e=t.payloadType;if(void 0!==t.preferredPayloadType&&(e=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var r=[];Object.keys(t.parameters).forEach((function(n){r.push(t.parameters[n]?n+"="+t.parameters[n]:n)})),n+="a=fmtp:"+e+" "+r.join(";")+"\r\n"}return n},n.parseRtcpFb=function(t){var n=t.substr(t.indexOf(" ")+1).split(" ");return{type:n.shift(),parameter:n.join(" ")}},n.writeRtcpFb=function(t){var n="",e=t.payloadType;return void 0!==t.preferredPayloadType&&(e=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach((function(t){n+="a=rtcp-fb:"+e+" "+t.type+(t.parameter&&t.parameter.length?" "+t.parameter:"")+"\r\n"})),n},n.parseSsrcMedia=function(t){var n=t.indexOf(" "),e={ssrc:parseInt(t.substr(7,n-7),10)},r=t.indexOf(":",n);return r>-1?(e.attribute=t.substr(n+1,r-n-1),e.value=t.substr(r+1)):e.attribute=t.substr(n+1),e},n.parseSsrcGroup=function(t){var n=t.substr(13).split(" ");return{semantics:n.shift(),ssrcs:n.map((function(t){return parseInt(t,10)}))}},n.getMid=function(t){var e=n.matchPrefix(t,"a=mid:")[0];if(e)return e.substr(6)},n.parseFingerprint=function(t){var n=t.substr(14).split(" ");return{algorithm:n[0].toLowerCase(),value:n[1]}},n.getDtlsParameters=function(t,e){return{role:"auto",fingerprints:n.matchPrefix(t+e,"a=fingerprint:").map(n.parseFingerprint)}},n.writeDtlsParameters=function(t,n){var e="a=setup:"+n+"\r\n";return t.fingerprints.forEach((function(t){e+="a=fingerprint:"+t.algorithm+" "+t.value+"\r\n"})),e},n.getIceParameters=function(t,e){var r=n.splitLines(t);return{usernameFragment:(r=r.concat(n.splitLines(e))).filter((function(t){return 0===t.indexOf("a=ice-ufrag:")}))[0].substr(12),password:r.filter((function(t){return 0===t.indexOf("a=ice-pwd:")}))[0].substr(10)}},n.writeIceParameters=function(t){return"a=ice-ufrag:"+t.usernameFragment+"\r\na=ice-pwd:"+t.password+"\r\n"},n.parseRtpParameters=function(t){for(var e={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=n.splitLines(t)[0].split(" "),i=3;i<r.length;i++){var o=r[i],s=n.matchPrefix(t,"a=rtpmap:"+o+" ")[0];if(s){var c=n.parseRtpMap(s),a=n.matchPrefix(t,"a=fmtp:"+o+" ");switch(c.parameters=a.length?n.parseFmtp(a[0]):{},c.rtcpFeedback=n.matchPrefix(t,"a=rtcp-fb:"+o+" ").map(n.parseRtcpFb),e.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":e.fecMechanisms.push(c.name.toUpperCase())}}}return n.matchPrefix(t,"a=extmap:").forEach((function(t){e.headerExtensions.push(n.parseExtmap(t))})),e},n.writeRtpDescription=function(t,e){var r="";r+="m="+t+" ",r+=e.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=e.codecs.map((function(t){return void 0!==t.preferredPayloadType?t.preferredPayloadType:t.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",e.codecs.forEach((function(t){r+=n.writeRtpMap(t),r+=n.writeFmtp(t),r+=n.writeRtcpFb(t)}));var i=0;return e.codecs.forEach((function(t){t.maxptime>i&&(i=t.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),r+="a=rtcp-mux\r\n",e.headerExtensions&&e.headerExtensions.forEach((function(t){r+=n.writeExtmap(t)})),r},n.parseRtpEncodingParameters=function(t){var e,r=[],i=n.parseRtpParameters(t),o=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),c=n.matchPrefix(t,"a=ssrc:").map((function(t){return n.parseSsrcMedia(t)})).filter((function(t){return"cname"===t.attribute})),a=c.length>0&&c[0].ssrc,u=n.matchPrefix(t,"a=ssrc-group:FID").map((function(t){return t.substr(17).split(" ").map((function(t){return parseInt(t,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===a&&(e=u[0][1]),i.codecs.forEach((function(t){if("RTX"===t.name.toUpperCase()&&t.parameters.apt){var n={ssrc:a,codecPayloadType:parseInt(t.parameters.apt,10)};a&&e&&(n.rtx={ssrc:e}),r.push(n),o&&((n=JSON.parse(JSON.stringify(n))).fec={ssrc:a,mechanism:s?"red+ulpfec":"red"},r.push(n))}})),0===r.length&&a&&r.push({ssrc:a});var f=n.matchPrefix(t,"b=");return f.length&&(f=0===f[0].indexOf("b=TIAS:")?parseInt(f[0].substr(7),10):0===f[0].indexOf("b=AS:")?1e3*parseInt(f[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(t){t.maxBitrate=f}))),r},n.parseRtcpParameters=function(t){var e={},r=n.matchPrefix(t,"a=ssrc:").map((function(t){return n.parseSsrcMedia(t)})).filter((function(t){return"cname"===t.attribute}))[0];r&&(e.cname=r.value,e.ssrc=r.ssrc);var i=n.matchPrefix(t,"a=rtcp-rsize");e.reducedSize=i.length>0,e.compound=0===i.length;var o=n.matchPrefix(t,"a=rtcp-mux");return e.mux=o.length>0,e},n.parseMsid=function(t){var e,r=n.matchPrefix(t,"a=msid:");if(1===r.length)return{stream:(e=r[0].substr(7).split(" "))[0],track:e[1]};var i=n.matchPrefix(t,"a=ssrc:").map((function(t){return n.parseSsrcMedia(t)})).filter((function(t){return"msid"===t.attribute}));return i.length>0?{stream:(e=i[0].value.split(" "))[0],track:e[1]}:void 0},n.parseSctpDescription=function(t){var e,r=n.parseMLine(t),i=n.matchPrefix(t,"a=max-message-size:");i.length>0&&(e=parseInt(i[0].substr(19),10)),isNaN(e)&&(e=65536);var o=n.matchPrefix(t,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:r.fmt,maxMessageSize:e};if(n.matchPrefix(t,"a=sctpmap:").length>0){var s=n.matchPrefix(t,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:e}}},n.writeSctpDescription=function(t,n){var e=[];return e="DTLS/SCTP"!==t.protocol?["m="+t.kind+" 9 "+t.protocol+" "+n.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+n.port+"\r\n"]:["m="+t.kind+" 9 "+t.protocol+" "+n.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+n.port+" "+n.protocol+" 65535\r\n"],void 0!==n.maxMessageSize&&e.push("a=max-message-size:"+n.maxMessageSize+"\r\n"),e.join("")},n.generateSessionId=function(){return Math.random().toString().substr(2,21)},n.writeSessionBoilerplate=function(t,e,r){var i=void 0!==e?e:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(t||n.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},n.writeMediaSection=function(t,e,r,i){var o=n.writeRtpDescription(t.kind,e);if(o+=n.writeIceParameters(t.iceGatherer.getLocalParameters()),o+=n.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+t.mid+"\r\n",o+=t.direction?"a="+t.direction+"\r\n":t.rtpSender&&t.rtpReceiver?"a=sendrecv\r\n":t.rtpSender?"a=sendonly\r\n":t.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",t.rtpSender){var s="msid:"+i.id+" "+t.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+s,t.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),o},n.getDirection=function(t,e){for(var r=n.splitLines(t),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return e?n.getDirection(e):"sendrecv"},n.getKind=function(t){return n.splitLines(t)[0].split(" ")[0].substr(2)},n.isRejected=function(t){return"0"===t.split(" ",2)[1]},n.parseMLine=function(t){var e=n.splitLines(t)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},n.parseOLine=function(t){var e=n.matchPrefix(t,"o=")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},n.isValidSDP=function(t){if("string"!=typeof t||0===t.length)return!1;for(var e=n.splitLines(t),r=0;r<e.length;r++)if(e[r].length<2||"="!==e[r].charAt(1))return!1;return!0},t.exports=n}(Mt={exports:{}}),Mt.exports);function Nt(t,n,e,r,i){var o=Rt.writeRtpDescription(t.kind,n);if(o+=Rt.writeIceParameters(t.iceGatherer.getLocalParameters()),o+=Rt.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),"offer"===e?"actpass":i||"active"),o+="a=mid:"+t.mid+"\r\n",o+=t.rtpSender&&t.rtpReceiver?"a=sendrecv\r\n":t.rtpSender?"a=sendonly\r\n":t.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",t.rtpSender){var s=t.rtpSender._initialTrackId||t.rtpSender.track.id;t.rtpSender._initialTrackId=s;var c="msid:"+(r?r.id:"-")+" "+s+"\r\n";o+="a="+c,o+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+c,t.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+c,o+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+Rt.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+Rt.localCName+"\r\n"),o}function At(t,n){var e={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(t,n){t=parseInt(t,10);for(var e=0;e<n.length;e++)if(n[e].payloadType===t||n[e].preferredPayloadType===t)return n[e]},i=function(t,n,e,i){var o=r(t.parameters.apt,e),s=r(n.parameters.apt,i);return o&&s&&o.name.toLowerCase()===s.name.toLowerCase()};return t.codecs.forEach((function(r){for(var o=0;o<n.codecs.length;o++){var s=n.codecs[o];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!i(r,s,t.codecs,n.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),e.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(t){for(var n=0;n<r.rtcpFeedback.length;n++)if(r.rtcpFeedback[n].type===t.type&&r.rtcpFeedback[n].parameter===t.parameter)return!0;return!1}));break}}})),t.headerExtensions.forEach((function(t){for(var r=0;r<n.headerExtensions.length;r++){var i=n.headerExtensions[r];if(t.uri===i.uri){e.headerExtensions.push(i);break}}})),e}function _t(t,n,e){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[n][t].indexOf(e)}function $t(t,n){var e=t.getRemoteCandidates().find((function(t){return n.foundation===t.foundation&&n.ip===t.ip&&n.port===t.port&&n.priority===t.priority&&n.protocol===t.protocol&&n.type===t.type}));return e||t.addRemoteCandidate(n),!e}function Lt(t,n){var e=new Error(n);return e.name=t,e.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[t],e}var Ut=function(t,n){function e(n,e){e.addTrack(n),e.dispatchEvent(new t.MediaStreamTrackEvent("addtrack",{track:n}))}function r(n,e,r,i){var o=new Event("track");o.track=e,o.receiver=r,o.transceiver={receiver:r},o.streams=i,t.setTimeout((function(){n._dispatchEvent("track",o)}))}var i=function(e){var r=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(t){r[t]=i[t].bind(i)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",e=JSON.parse(JSON.stringify(e||{})),this.usingBundle="max-bundle"===e.bundlePolicy,"negotiate"===e.rtcpMuxPolicy)throw Lt("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(e.rtcpMuxPolicy||(e.rtcpMuxPolicy="require"),e.iceTransportPolicy){case"all":case"relay":break;default:e.iceTransportPolicy="all"}switch(e.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:e.bundlePolicy="balanced"}if(e.iceServers=function(t,n){var e=!1;return(t=JSON.parse(JSON.stringify(t))).filter((function(t){if(t&&(t.urls||t.url)){var r=t.urls||t.url;t.url&&!t.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(t){return 0!==t.indexOf("turn:")||-1===t.indexOf("transport=udp")||-1!==t.indexOf("turn:[")||e?0===t.indexOf("stun:")&&n>=14393&&-1===t.indexOf("?transport=udp"):(e=!0,!0)})),delete t.url,t.urls=i?r[0]:r,!!r.length}}))}(e.iceServers||[],n),this._iceGatherers=[],e.iceCandidatePoolSize)for(var o=e.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new t.RTCIceGatherer({iceServers:e.iceServers,gatherPolicy:e.iceTransportPolicy}));else e.iceCandidatePoolSize=0;this._config=e,this.transceivers=[],this._sdpSessionId=Rt.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(t,n){this._isClosed||(this.dispatchEvent(n),"function"==typeof this["on"+t]&&this["on"+t](n))},i.prototype._emitGatheringStateChange=function(){var t=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",t)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(t,n){var e={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:t,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&this.transceivers.length>0)e.iceTransport=this.transceivers[0].iceTransport,e.dtlsTransport=this.transceivers[0].dtlsTransport;else{var r=this._createIceAndDtlsTransports();e.iceTransport=r.iceTransport,e.dtlsTransport=r.dtlsTransport}return n||this.transceivers.push(e),e},i.prototype.addTrack=function(n,e){if(this._isClosed)throw Lt("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(t){return t.track===n})))throw Lt("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==n.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(n.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(e)&&this.localStreams.push(e),r.track=n,r.stream=e,r.rtpSender=new t.RTCRtpSender(n,r.dtlsTransport),r.rtpSender},i.prototype.addStream=function(t){var e=this;if(n>=15025)t.getTracks().forEach((function(n){e.addTrack(n,t)}));else{var r=t.clone();t.getTracks().forEach((function(t,n){var e=r.getTracks()[n];t.addEventListener("enabled",(function(t){e.enabled=t.enabled}))})),r.getTracks().forEach((function(t){e.addTrack(t,r)}))}},i.prototype.removeTrack=function(n){if(this._isClosed)throw Lt("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(n instanceof t.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var e=this.transceivers.find((function(t){return t.rtpSender===n}));if(!e)throw Lt("InvalidAccessError","Sender was not created by this connection.");var r=e.stream;e.rtpSender.stop(),e.rtpSender=null,e.track=null,e.stream=null,-1===this.transceivers.map((function(t){return t.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(t){var n=this;t.getTracks().forEach((function(t){var e=n.getSenders().find((function(n){return n.track===t}));e&&n.removeTrack(e)}))},i.prototype.getSenders=function(){return this.transceivers.filter((function(t){return!!t.rtpSender})).map((function(t){return t.rtpSender}))},i.prototype.getReceivers=function(){return this.transceivers.filter((function(t){return!!t.rtpReceiver})).map((function(t){return t.rtpReceiver}))},i.prototype._createIceGatherer=function(n,e){var r=this;if(e&&n>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new t.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[n].bufferedCandidateEvents=[],this.transceivers[n].bufferCandidates=function(t){var e=!t.candidate||0===Object.keys(t.candidate).length;i.state=e?"completed":"gathering",null!==r.transceivers[n].bufferedCandidateEvents&&r.transceivers[n].bufferedCandidateEvents.push(t)},i.addEventListener("localcandidate",this.transceivers[n].bufferCandidates),i},i.prototype._gather=function(n,e){var r=this,i=this.transceivers[e].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[e].bufferedCandidateEvents;this.transceivers[e].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[e].bufferCandidates),i.onlocalcandidate=function(t){if(!(r.usingBundle&&e>0)){var o=new Event("icecandidate");o.candidate={sdpMid:n,sdpMLineIndex:e};var s=t.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==i.state&&"gathering"!==i.state||(i.state="completed");else{"new"===i.state&&(i.state="gathering"),s.component=1,s.ufrag=i.getLocalParameters().usernameFragment;var a=Rt.writeCandidate(s);o.candidate=Object.assign(o.candidate,Rt.parseCandidate(a)),o.candidate.candidate=a,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var u=Rt.getMediaSections(r._localDescription.sdp);u[o.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",r._localDescription.sdp=Rt.getDescription(r._localDescription.sdp)+u.join("");var f=r.transceivers.every((function(t){return t.iceGatherer&&"completed"===t.iceGatherer.state}));"gathering"!==r.iceGatheringState&&(r.iceGatheringState="gathering",r._emitGatheringStateChange()),c||r._dispatchEvent("icecandidate",o),f&&(r._dispatchEvent("icecandidate",new Event("icecandidate")),r.iceGatheringState="complete",r._emitGatheringStateChange())}},t.setTimeout((function(){o.forEach((function(t){i.onlocalcandidate(t)}))}),0)}},i.prototype._createIceAndDtlsTransports=function(){var n=this,e=new t.RTCIceTransport(null);e.onicestatechange=function(){n._updateIceConnectionState(),n._updateConnectionState()};var r=new t.RTCDtlsTransport(e);return r.ondtlsstatechange=function(){n._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),n._updateConnectionState()},{iceTransport:e,dtlsTransport:r}},i.prototype._disposeIceAndDtlsTransports=function(t){var n=this.transceivers[t].iceGatherer;n&&(delete n.onlocalcandidate,delete this.transceivers[t].iceGatherer);var e=this.transceivers[t].iceTransport;e&&(delete e.onicestatechange,delete this.transceivers[t].iceTransport);var r=this.transceivers[t].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[t].dtlsTransport)},i.prototype._transceive=function(t,e,r){var i=At(t.localCapabilities,t.remoteCapabilities);e&&t.rtpSender&&(i.encodings=t.sendEncodingParameters,i.rtcp={cname:Rt.localCName,compound:t.rtcpParameters.compound},t.recvEncodingParameters.length&&(i.rtcp.ssrc=t.recvEncodingParameters[0].ssrc),t.rtpSender.send(i)),r&&t.rtpReceiver&&i.codecs.length>0&&("video"===t.kind&&t.recvEncodingParameters&&n<15019&&t.recvEncodingParameters.forEach((function(t){delete t.rtx})),i.encodings=t.recvEncodingParameters.length?t.recvEncodingParameters:[{}],i.rtcp={compound:t.rtcpParameters.compound},t.rtcpParameters.cname&&(i.rtcp.cname=t.rtcpParameters.cname),t.sendEncodingParameters.length&&(i.rtcp.ssrc=t.sendEncodingParameters[0].ssrc),t.rtpReceiver.receive(i))},i.prototype.setLocalDescription=function(t){var n,e,r=this;if(-1===["offer","answer"].indexOf(t.type))return Promise.reject(Lt("TypeError",'Unsupported type "'+t.type+'"'));if(!_t("setLocalDescription",t.type,r.signalingState)||r._isClosed)return Promise.reject(Lt("InvalidStateError","Can not set local "+t.type+" in state "+r.signalingState));if("offer"===t.type)n=Rt.splitSections(t.sdp),e=n.shift(),n.forEach((function(t,n){var e=Rt.parseRtpParameters(t);r.transceivers[n].localCapabilities=e})),r.transceivers.forEach((function(t,n){r._gather(t.mid,n)}));else if("answer"===t.type){n=Rt.splitSections(r._remoteDescription.sdp),e=n.shift();var i=Rt.matchPrefix(e,"a=ice-lite").length>0;n.forEach((function(t,n){var o=r.transceivers[n],s=o.iceGatherer,c=o.iceTransport,a=o.dtlsTransport,u=o.localCapabilities,f=o.remoteCapabilities;if(!(Rt.isRejected(t)&&0===Rt.matchPrefix(t,"a=bundle-only").length||o.rejected)){var l=Rt.getIceParameters(t,e),d=Rt.getDtlsParameters(t,e);i&&(d.role="server"),r.usingBundle&&0!==n||(r._gather(o.mid,n),"new"===c.state&&c.start(s,l,i?"controlling":"controlled"),"new"===a.state&&a.start(d));var h=At(u,f);r._transceive(o,h.codecs.length>0,!1)}}))}return r._localDescription={type:t.type,sdp:t.sdp},r._updateSignalingState("offer"===t.type?"have-local-offer":"stable"),Promise.resolve()},i.prototype.setRemoteDescription=function(i){var o=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(Lt("TypeError",'Unsupported type "'+i.type+'"'));if(!_t("setRemoteDescription",i.type,o.signalingState)||o._isClosed)return Promise.reject(Lt("InvalidStateError","Can not set remote "+i.type+" in state "+o.signalingState));var s={};o.remoteStreams.forEach((function(t){s[t.id]=t}));var c=[],a=Rt.splitSections(i.sdp),u=a.shift(),f=Rt.matchPrefix(u,"a=ice-lite").length>0,l=Rt.matchPrefix(u,"a=group:BUNDLE ").length>0;o.usingBundle=l;var d=Rt.matchPrefix(u,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!d&&d.substr(14).split(" ").indexOf("trickle")>=0,a.forEach((function(r,a){var d=Rt.splitLines(r),h=Rt.getKind(r),p=Rt.isRejected(r)&&0===Rt.matchPrefix(r,"a=bundle-only").length,m=d[0].substr(2).split(" ")[2],v=Rt.getDirection(r,u),w=Rt.parseMsid(r),b=Rt.getMid(r)||Rt.generateIdentifier();if(p||"application"===h&&("DTLS/SCTP"===m||"UDP/DTLS/SCTP"===m))o.transceivers[a]={mid:b,kind:h,protocol:m,rejected:!0};else{var g,y,S,E,O,j,T,I,C;!p&&o.transceivers[a]&&o.transceivers[a].rejected&&(o.transceivers[a]=o._createTransceiver(h,!0));var P,k,D=Rt.parseRtpParameters(r);p||(P=Rt.getIceParameters(r,u),(k=Rt.getDtlsParameters(r,u)).role="client"),T=Rt.parseRtpEncodingParameters(r);var x=Rt.parseRtcpParameters(r),M=Rt.matchPrefix(r,"a=end-of-candidates",u).length>0,R=Rt.matchPrefix(r,"a=candidate:").map((function(t){return Rt.parseCandidate(t)})).filter((function(t){return 1===t.component}));if(("offer"===i.type||"answer"===i.type)&&!p&&l&&a>0&&o.transceivers[a]&&(o._disposeIceAndDtlsTransports(a),o.transceivers[a].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[a].iceTransport=o.transceivers[0].iceTransport,o.transceivers[a].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[a].rtpSender&&o.transceivers[a].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[a].rtpReceiver&&o.transceivers[a].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==i.type||p)"answer"!==i.type||p||(y=(g=o.transceivers[a]).iceGatherer,S=g.iceTransport,E=g.dtlsTransport,O=g.rtpReceiver,j=g.sendEncodingParameters,I=g.localCapabilities,o.transceivers[a].recvEncodingParameters=T,o.transceivers[a].remoteCapabilities=D,o.transceivers[a].rtcpParameters=x,R.length&&"new"===S.state&&(!f&&!M||l&&0!==a?R.forEach((function(t){$t(g.iceTransport,t)})):S.setRemoteCandidates(R)),l&&0!==a||("new"===S.state&&S.start(y,P,"controlling"),"new"===E.state&&E.start(k)),!At(g.localCapabilities,g.remoteCapabilities).codecs.filter((function(t){return"rtx"===t.name.toLowerCase()})).length&&g.sendEncodingParameters[0].rtx&&delete g.sendEncodingParameters[0].rtx,o._transceive(g,"sendrecv"===v||"recvonly"===v,"sendrecv"===v||"sendonly"===v),!O||"sendrecv"!==v&&"sendonly"!==v?delete g.rtpReceiver:(C=O.track,w?(s[w.stream]||(s[w.stream]=new t.MediaStream),e(C,s[w.stream]),c.push([C,O,s[w.stream]])):(s.default||(s.default=new t.MediaStream),e(C,s.default),c.push([C,O,s.default]))));else{(g=o.transceivers[a]||o._createTransceiver(h)).mid=b,g.iceGatherer||(g.iceGatherer=o._createIceGatherer(a,l)),R.length&&"new"===g.iceTransport.state&&(!M||l&&0!==a?R.forEach((function(t){$t(g.iceTransport,t)})):g.iceTransport.setRemoteCandidates(R)),I=t.RTCRtpReceiver.getCapabilities(h),n<15019&&(I.codecs=I.codecs.filter((function(t){return"rtx"!==t.name}))),j=g.sendEncodingParameters||[{ssrc:1001*(2*a+2)}];var N,A=!1;"sendrecv"===v||"sendonly"===v?(A=!g.rtpReceiver,O=g.rtpReceiver||new t.RTCRtpReceiver(g.dtlsTransport,h),A&&(C=O.track,w&&"-"===w.stream||(w?(s[w.stream]||(s[w.stream]=new t.MediaStream,Object.defineProperty(s[w.stream],"id",{get:function(){return w.stream}})),Object.defineProperty(C,"id",{get:function(){return w.track}}),N=s[w.stream]):(s.default||(s.default=new t.MediaStream),N=s.default)),N&&(e(C,N),g.associatedRemoteMediaStreams.push(N)),c.push([C,O,N]))):g.rtpReceiver&&g.rtpReceiver.track&&(g.associatedRemoteMediaStreams.forEach((function(n){var e=n.getTracks().find((function(t){return t.id===g.rtpReceiver.track.id}));e&&function(n,e){e.removeTrack(n),e.dispatchEvent(new t.MediaStreamTrackEvent("removetrack",{track:n}))}(e,n)})),g.associatedRemoteMediaStreams=[]),g.localCapabilities=I,g.remoteCapabilities=D,g.rtpReceiver=O,g.rtcpParameters=x,g.sendEncodingParameters=j,g.recvEncodingParameters=T,o._transceive(o.transceivers[a],!1,A)}}})),void 0===o._dtlsRole&&(o._dtlsRole="offer"===i.type?"active":"passive"),o._remoteDescription={type:i.type,sdp:i.sdp},o._updateSignalingState("offer"===i.type?"have-remote-offer":"stable"),Object.keys(s).forEach((function(n){var e=s[n];if(e.getTracks().length){if(-1===o.remoteStreams.indexOf(e)){o.remoteStreams.push(e);var i=new Event("addstream");i.stream=e,t.setTimeout((function(){o._dispatchEvent("addstream",i)}))}c.forEach((function(t){e.id===t[2].id&&r(o,t[0],t[1],[e])}))}})),c.forEach((function(t){t[2]||r(o,t[0],t[1],[])})),t.setTimeout((function(){o&&o.transceivers&&o.transceivers.forEach((function(t){t.iceTransport&&"new"===t.iceTransport.state&&t.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),t.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach((function(t){t.iceTransport&&t.iceTransport.stop(),t.dtlsTransport&&t.dtlsTransport.stop(),t.rtpSender&&t.rtpSender.stop(),t.rtpReceiver&&t.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(t){this.signalingState=t;var n=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",n)},i.prototype._maybeFireNegotiationNeeded=function(){var n=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,t.setTimeout((function(){if(n.needNegotiation){n.needNegotiation=!1;var t=new Event("negotiationneeded");n._dispatchEvent("negotiationneeded",t)}}),0))},i.prototype._updateIceConnectionState=function(){var t,n={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(t){t.iceTransport&&!t.rejected&&n[t.iceTransport.state]++})),t="new",n.failed>0?t="failed":n.checking>0?t="checking":n.disconnected>0?t="disconnected":n.new>0?t="new":n.connected>0?t="connected":n.completed>0&&(t="completed"),t!==this.iceConnectionState){this.iceConnectionState=t;var e=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",e)}},i.prototype._updateConnectionState=function(){var t,n={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(t){t.iceTransport&&t.dtlsTransport&&!t.rejected&&(n[t.iceTransport.state]++,n[t.dtlsTransport.state]++)})),n.connected+=n.completed,t="new",n.failed>0?t="failed":n.connecting>0?t="connecting":n.disconnected>0?t="disconnected":n.new>0?t="new":n.connected>0&&(t="connected"),t!==this.connectionState){this.connectionState=t;var e=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",e)}},i.prototype.createOffer=function(){var e=this;if(e._isClosed)return Promise.reject(Lt("InvalidStateError","Can not call createOffer after close"));var r=e.transceivers.filter((function(t){return"audio"===t.kind})).length,i=e.transceivers.filter((function(t){return"video"===t.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(r=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(i=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(e.transceivers.forEach((function(t){"audio"===t.kind?--r<0&&(t.wantReceive=!1):"video"===t.kind&&--i<0&&(t.wantReceive=!1)}));r>0||i>0;)r>0&&(e._createTransceiver("audio"),r--),i>0&&(e._createTransceiver("video"),i--);var s=Rt.writeSessionBoilerplate(e._sdpSessionId,e._sdpSessionVersion++);e.transceivers.forEach((function(r,i){var o=r.track,s=r.kind,c=r.mid||Rt.generateIdentifier();r.mid=c,r.iceGatherer||(r.iceGatherer=e._createIceGatherer(i,e.usingBundle));var a=t.RTCRtpSender.getCapabilities(s);n<15019&&(a.codecs=a.codecs.filter((function(t){return"rtx"!==t.name}))),a.codecs.forEach((function(t){"H264"===t.name&&void 0===t.parameters["level-asymmetry-allowed"]&&(t.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach((function(n){t.name.toLowerCase()===n.name.toLowerCase()&&t.clockRate===n.clockRate&&(t.preferredPayloadType=n.payloadType)}))})),a.headerExtensions.forEach((function(t){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach((function(n){t.uri===n.uri&&(t.id=n.id)}))}));var u=r.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];o&&n>=15019&&"video"===s&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new t.RTCRtpReceiver(r.dtlsTransport,s)),r.localCapabilities=a,r.sendEncodingParameters=u})),"max-compat"!==e._config.bundlePolicy&&(s+="a=group:BUNDLE "+e.transceivers.map((function(t){return t.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n",e.transceivers.forEach((function(t,n){s+=Nt(t,t.localCapabilities,"offer",t.stream,e._dtlsRole),s+="a=rtcp-rsize\r\n",!t.iceGatherer||"new"===e.iceGatheringState||0!==n&&e.usingBundle||(t.iceGatherer.getLocalCandidates().forEach((function(t){t.component=1,s+="a="+Rt.writeCandidate(t)+"\r\n"})),"completed"===t.iceGatherer.state&&(s+="a=end-of-candidates\r\n"))}));var c=new t.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(c)},i.prototype.createAnswer=function(){var e=this;if(e._isClosed)return Promise.reject(Lt("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==e.signalingState&&"have-local-pranswer"!==e.signalingState)return Promise.reject(Lt("InvalidStateError","Can not call createAnswer in signalingState "+e.signalingState));var r=Rt.writeSessionBoilerplate(e._sdpSessionId,e._sdpSessionVersion++);e.usingBundle&&(r+="a=group:BUNDLE "+e.transceivers.map((function(t){return t.mid})).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n";var i=Rt.getMediaSections(e._remoteDescription.sdp).length;e.transceivers.forEach((function(t,o){if(!(o+1>i)){if(t.rejected)return"application"===t.kind?r+="DTLS/SCTP"===t.protocol?"m=application 0 DTLS/SCTP 5000\r\n":"m=application 0 "+t.protocol+" webrtc-datachannel\r\n":"audio"===t.kind?r+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===t.kind&&(r+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(r+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+t.mid+"\r\n");var s;t.stream&&("audio"===t.kind?s=t.stream.getAudioTracks()[0]:"video"===t.kind&&(s=t.stream.getVideoTracks()[0]),s&&n>=15019&&"video"===t.kind&&!t.sendEncodingParameters[0].rtx&&(t.sendEncodingParameters[0].rtx={ssrc:t.sendEncodingParameters[0].ssrc+1}));var c=At(t.localCapabilities,t.remoteCapabilities);!c.codecs.filter((function(t){return"rtx"===t.name.toLowerCase()})).length&&t.sendEncodingParameters[0].rtx&&delete t.sendEncodingParameters[0].rtx,r+=Nt(t,c,"answer",t.stream,e._dtlsRole),t.rtcpParameters&&t.rtcpParameters.reducedSize&&(r+="a=rtcp-rsize\r\n")}}));var o=new t.RTCSessionDescription({type:"answer",sdp:r});return Promise.resolve(o)},i.prototype.addIceCandidate=function(t){var n,e=this;return t&&void 0===t.sdpMLineIndex&&!t.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(r,i){if(!e._remoteDescription)return i(Lt("InvalidStateError","Can not add ICE candidate without a remote description"));if(t&&""!==t.candidate){var o=t.sdpMLineIndex;if(t.sdpMid)for(var s=0;s<e.transceivers.length;s++)if(e.transceivers[s].mid===t.sdpMid){o=s;break}var c=e.transceivers[o];if(!c)return i(Lt("OperationError","Can not add ICE candidate"));if(c.rejected)return r();var a=Object.keys(t.candidate).length>0?Rt.parseCandidate(t.candidate):{};if("tcp"===a.protocol&&(0===a.port||9===a.port))return r();if(a.component&&1!==a.component)return r();if((0===o||o>0&&c.iceTransport!==e.transceivers[0].iceTransport)&&!$t(c.iceTransport,a))return i(Lt("OperationError","Can not add ICE candidate"));var u=t.candidate.trim();0===u.indexOf("a=")&&(u=u.substr(2)),(n=Rt.getMediaSections(e._remoteDescription.sdp))[o]+="a="+(a.type?u:"end-of-candidates")+"\r\n",e._remoteDescription.sdp=Rt.getDescription(e._remoteDescription.sdp)+n.join("")}else for(var f=0;f<e.transceivers.length&&(e.transceivers[f].rejected||(e.transceivers[f].iceTransport.addRemoteCandidate({}),(n=Rt.getMediaSections(e._remoteDescription.sdp))[f]+="a=end-of-candidates\r\n",e._remoteDescription.sdp=Rt.getDescription(e._remoteDescription.sdp)+n.join(""),!e.usingBundle));f++);r()}))},i.prototype.getStats=function(n){if(n&&n instanceof t.MediaStreamTrack){var e=null;if(this.transceivers.forEach((function(t){t.rtpSender&&t.rtpSender.track===n?e=t.rtpSender:t.rtpReceiver&&t.rtpReceiver.track===n&&(e=t.rtpReceiver)})),!e)throw Lt("InvalidAccessError","Invalid selector.");return e.getStats()}var r=[];return this.transceivers.forEach((function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(n){t[n]&&r.push(t[n].getStats())}))})),Promise.all(r).then((function(t){var n=new Map;return t.forEach((function(t){t.forEach((function(t){n.set(t.id,t)}))})),n}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(n){var e=t[n];if(e&&e.prototype&&e.prototype.getStats){var r=e.prototype.getStats;e.prototype.getStats=function(){return r.apply(this).then((function(t){var n=new Map;return Object.keys(t).forEach((function(e){var r;t[e].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=t[e]).type]||r.type,n.set(e,t[e])})),n}))}}}));var o=["createOffer","createAnswer"];return o.forEach((function(t){var n=i.prototype[t];i.prototype[t]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?n.apply(this,[arguments[2]]).then((function(n){"function"==typeof t[0]&&t[0].apply(null,[n])}),(function(n){"function"==typeof t[1]&&t[1].apply(null,[n])})):n.apply(this,arguments)}})),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(t){var n=i.prototype[t];i.prototype[t]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?n.apply(this,arguments).then((function(){"function"==typeof t[1]&&t[1].apply(null)}),(function(n){"function"==typeof t[2]&&t[2].apply(null,[n])})):n.apply(this,arguments)}})),["getStats"].forEach((function(t){var n=i.prototype[t];i.prototype[t]=function(){var t=arguments;return"function"==typeof t[1]?n.apply(this,arguments).then((function(){"function"==typeof t[1]&&t[1].apply(null)})):n.apply(this,arguments)}})),i};function Ft(t){const n=t&&t.navigator,e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return e(t).catch(t=>Promise.reject(function(t){return{name:{PermissionDeniedError:"NotAllowedError"}[t.name]||t.name,message:t.message,constraint:t.constraint,toString(){return this.name}}}(t)))}}function Gt(t){"getDisplayMedia"in t.navigator&&t.navigator.mediaDevices&&(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||(t.navigator.mediaDevices.getDisplayMedia=t.navigator.getDisplayMedia.bind(t.navigator)))}function Jt(t){const n=vt(t);if(t.RTCIceGatherer&&(t.RTCIceCandidate||(t.RTCIceCandidate=function(t){return t}),t.RTCSessionDescription||(t.RTCSessionDescription=function(t){return t}),n.version<15025)){const n=Object.getOwnPropertyDescriptor(t.MediaStreamTrack.prototype,"enabled");Object.defineProperty(t.MediaStreamTrack.prototype,"enabled",{set(t){n.set.call(this,t);const e=new Event("enabled");e.enabled=t,this.dispatchEvent(e)}})}!t.RTCRtpSender||"dtmf"in t.RTCRtpSender.prototype||Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new t.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),t.RTCDtmfSender&&!t.RTCDTMFSender&&(t.RTCDTMFSender=t.RTCDtmfSender);const e=Ut(t,n.version);t.RTCPeerConnection=function(t){return t&&t.iceServers&&(t.iceServers=function(t){let n=!1;return(t=JSON.parse(JSON.stringify(t))).filter(t=>{if(t&&(t.urls||t.url)){var e=t.urls||t.url;t.url&&!t.urls&&mt("RTCIceServer.url","RTCIceServer.urls");const r="string"==typeof e;return r&&(e=[e]),e=e.filter(t=>{if(0===t.indexOf("stun:"))return!1;const e=t.startsWith("turn")&&!t.startsWith("turn:[")&&t.includes("transport=udp");return e&&!n?(n=!0,!0):e&&!n}),delete t.url,t.urls=r?e[0]:e,!!e.length}})}(t.iceServers),pt("ICE servers after filtering:",t.iceServers)),new e(t)},t.RTCPeerConnection.prototype=e.prototype}function zt(t){!t.RTCRtpSender||"replaceTrack"in t.RTCRtpSender.prototype||(t.RTCRtpSender.prototype.replaceTrack=t.RTCRtpSender.prototype.setTrack)}const Vt=Object.freeze({__proto__:null,shimPeerConnection:Jt,shimReplaceTrack:zt,shimGetUserMedia:Ft,shimGetDisplayMedia:Gt});function Wt(t){const n=vt(t),e=t&&t.navigator,r=t&&t.MediaStreamTrack;if(e.getUserMedia=function(t,n,r){mt("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),e.mediaDevices.getUserMedia(t).then(n,r)},!(n.version>55&&"autoGainControl"in e.mediaDevices.getSupportedConstraints())){const t=function(t,n,e){n in t&&!(e in t)&&(t[e]=t[n],delete t[n])},n=e.mediaDevices.getUserMedia.bind(e.mediaDevices);if(e.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),t(e.audio,"autoGainControl","mozAutoGainControl"),t(e.audio,"noiseSuppression","mozNoiseSuppression")),n(e)},r&&r.prototype.getSettings){const n=r.prototype.getSettings;r.prototype.getSettings=function(){const e=n.apply(this,arguments);return t(e,"mozAutoGainControl","autoGainControl"),t(e,"mozNoiseSuppression","noiseSuppression"),e}}if(r&&r.prototype.applyConstraints){const n=r.prototype.applyConstraints;r.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),t(e,"autoGainControl","mozAutoGainControl"),t(e,"noiseSuppression","mozNoiseSuppression")),n.apply(this,[e])}}}}function Bt(t){"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function qt(t){const n=vt(t);if("object"!=typeof t||!t.RTCPeerConnection&&!t.mozRTCPeerConnection)return;if(!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),n.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(n){const e=t.RTCPeerConnection.prototype[n];t.RTCPeerConnection.prototype[n]={[n](){return arguments[0]=new("addIceCandidate"===n?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),e.apply(this,arguments)}}[n]})),n.version<68){const n=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}const e={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[t,i,o]=arguments;return r.apply(this,[t||null]).then(t=>{if(n.version<53&&!i)try{t.forEach(t=>{t.type=e[t.type]||t.type})}catch(r){if("TypeError"!==r.name)throw r;t.forEach((n,r)=>{t.set(r,Object.assign({},n,{type:e[n.type]||n.type}))})}return t}).then(i,o)}}function Ht(t){if("object"!=typeof t||!t.RTCPeerConnection||!t.RTCRtpSender)return;if(t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const t=n.apply(this,[]);return t.forEach(t=>t._pc=this),t});const e=t.RTCPeerConnection.prototype.addTrack;e&&(t.RTCPeerConnection.prototype.addTrack=function(){const t=e.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Kt(t){if("object"!=typeof t||!t.RTCPeerConnection||!t.RTCRtpSender)return;if(t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const t=n.apply(this,[]);return t.forEach(t=>t._pc=this),t}),lt(t,"track",t=>(t.receiver._pc=t.srcElement,t)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Xt(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){mt("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&t.getTracks().includes(n.track)&&this.removeTrack(n)})})}function Qt(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function Yt(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const n=t.RTCPeerConnection.prototype.addTransceiver;n&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const t=arguments[1],e=t&&"sendEncodings"in t;e&&t.sendEncodings.forEach(t=>{if("rid"in t&&!/^[a-z0-9]{0,16}$/i.test(t.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in t&&!(parseFloat(t.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in t&&!(parseFloat(t.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const r=n.apply(this,arguments);if(e){const{sender:n}=r,e=n.getParameters();"encodings"in e||(e.encodings=t.sendEncodings,this.setParametersPromises.push(n.setParameters(e).catch(()=>{})))}return r})}function Zt(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const n=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>n.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):n.apply(this,arguments)}}function tn(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const n=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>n.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):n.apply(this,arguments)}}const nn=Object.freeze({__proto__:null,shimOnTrack:Bt,shimPeerConnection:qt,shimSenderGetStats:Ht,shimReceiverGetStats:Kt,shimRemoveStream:Xt,shimRTCDataChannel:Qt,shimAddTransceiver:Yt,shimCreateOffer:Zt,shimCreateAnswer:tn,shimGetUserMedia:Wt,shimGetDisplayMedia:function(t,n){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(e){if(!e||!e.video){const t=new DOMException("getDisplayMedia without video constraints is undefined");return t.name="NotFoundError",t.code=8,Promise.reject(t)}return!0===e.video?e.video={mediaSource:n}:e.video.mediaSource=n,t.navigator.mediaDevices.getUserMedia(e)})}});function en(t){if("object"==typeof t&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const n=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(t){this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(e=>n.call(this,e,t)),t.getVideoTracks().forEach(e=>n.call(this,e,t))},t.RTCPeerConnection.prototype.addTrack=function(t){const e=arguments[1];return e&&(this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]),n.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(t);if(-1===n)return;this._localStreams.splice(n,1);const e=t.getTracks();this.getSenders().forEach(t=>{e.includes(t.track)&&this.removeTrack(t)})})}}function rn(t){if("object"==typeof t&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=t=>{t.streams.forEach(t=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(t))return;this._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,this.dispatchEvent(n)})})}});const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(n){n.streams.forEach(n=>{if(t._remoteStreams||(t._remoteStreams=[]),t._remoteStreams.indexOf(n)>=0)return;t._remoteStreams.push(n);const e=new Event("addstream");e.stream=n,t.dispatchEvent(e)})}),n.apply(t,arguments)}}}function on(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const n=t.RTCPeerConnection.prototype,e=n.createOffer,r=n.createAnswer,i=n.setLocalDescription,o=n.setRemoteDescription,s=n.addIceCandidate;n.createOffer=function(t,n){const r=arguments.length>=2?arguments[2]:arguments[0],i=e.apply(this,[r]);return n?(i.then(t,n),Promise.resolve()):i},n.createAnswer=function(t,n){const e=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};let c=function(t,n,e){const r=i.apply(this,[t]);return e?(r.then(n,e),Promise.resolve()):r};n.setLocalDescription=c,n.setRemoteDescription=c=function(t,n,e){const r=o.apply(this,[t]);return e?(r.then(n,e),Promise.resolve()):r},n.addIceCandidate=c=function(t,n,e){const r=s.apply(this,[t]);return e?(r.then(n,e),Promise.resolve()):r}}function sn(t){const n=t&&t.navigator;if(n.mediaDevices&&n.mediaDevices.getUserMedia){const t=n.mediaDevices,e=t.getUserMedia.bind(t);n.mediaDevices.getUserMedia=t=>e(cn(t))}!n.getUserMedia&&n.mediaDevices&&n.mediaDevices.getUserMedia&&(n.getUserMedia=function(t,e,r){n.mediaDevices.getUserMedia(t).then(e,r)}.bind(n))}function cn(t){return t&&void 0!==t.video?Object.assign({},t,{video:bt(t.video)}):t}function an(t){const n=t.RTCPeerConnection;t.RTCPeerConnection=function(t,e){if(t&&t.iceServers){const n=[];for(let e=0;e<t.iceServers.length;e++){let r=t.iceServers[e];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(mt("RTCIceServer.url","RTCIceServer.urls"),(r=JSON.parse(JSON.stringify(r))).urls=r.url,delete r.url,n.push(r)):n.push(t.iceServers[e])}t.iceServers=n}return new n(t,e)},t.RTCPeerConnection.prototype=n.prototype,"generateCertificate"in t.RTCPeerConnection&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:()=>n.generateCertificate})}function un(t){"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fn(t){const n=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(t){if(t){void 0!==t.offerToReceiveAudio&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);const n=this.getTransceivers().find(t=>"audio"===t.receiver.track.kind);!1===t.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==t.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==t.offerToReceiveVideo&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);const e=this.getTransceivers().find(t=>"video"===t.receiver.track.kind);!1===t.offerToReceiveVideo&&e?"sendrecv"===e.direction?e.setDirection?e.setDirection("sendonly"):e.direction="sendonly":"recvonly"===e.direction&&(e.setDirection?e.setDirection("inactive"):e.direction="inactive"):!0!==t.offerToReceiveVideo||e||this.addTransceiver("video")}return n.apply(this,arguments)}}const ln=Object.freeze({__proto__:null,shimLocalStreamsAPI:en,shimRemoteStreamsAPI:rn,shimCallbacksAPI:on,shimGetUserMedia:sn,shimConstraints:cn,shimRTCIceServerUrls:an,shimTrackEventTransceiver:un,shimCreateOfferLegacy:fn});function dn(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const n=t.RTCIceCandidate;t.RTCIceCandidate=function(t){if("object"==typeof t&&t.candidate&&0===t.candidate.indexOf("a=")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substr(2)),t.candidate&&t.candidate.length){const e=new n(t),r=Rt.parseCandidate(t.candidate),i=Object.assign(e,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new n(t)},t.RTCIceCandidate.prototype=n.prototype,lt(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function hn(t){if(!t.RTCPeerConnection)return;const n=vt(t);"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const e=function(t){if(!t||!t.sdp)return!1;const n=Rt.splitSections(t.sdp);return n.shift(),n.some(t=>{const n=Rt.parseMLine(t);return n&&"application"===n.kind&&-1!==n.protocol.indexOf("SCTP")})},r=function(t){const n=t.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===n||n.length<2)return-1;const e=parseInt(n[1],10);return e!=e?-1:e},i=function(t){let e=65536;return"firefox"===n.browser&&(e=n.version<57?-1===t?16384:2147483637:n.version<60?57===n.version?65535:65536:2147483637),e},o=function(t,e){let r=65536;"firefox"===n.browser&&57===n.version&&(r=65535);const i=Rt.matchPrefix(t.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===n.browser&&-1!==e&&(r=2147483637),r},s=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===n.browser&&n.version>=76){const{sdpSemantics:t}=this.getConfiguration();"plan-b"===t&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(e(arguments[0])){const t=r(arguments[0]),n=i(t),e=o(arguments[0],t);let s;s=0===n&&0===e?Number.POSITIVE_INFINITY:0===n||0===e?Math.max(n,e):Math.min(n,e);const c={};Object.defineProperty(c,"maxMessageSize",{get:()=>s}),this._sctp=c}return s.apply(this,arguments)}}function pn(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function n(t,n){const e=t.send;t.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===t.readyState&&n.sctp&&i>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return e.apply(t,arguments)}}const e=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const t=e.apply(this,arguments);return n(t,this),t},lt(t,"datachannel",t=>(n(t.channel,t.target),t))}function mn(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const n=t.RTCPeerConnection.prototype;Object.defineProperty(n,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(n,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const e=n[t];n[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=t=>{const n=t.target;if(n._lastConnectionState!==n.connectionState){n._lastConnectionState=n.connectionState;const e=new Event("connectionstatechange",t);n.dispatchEvent(e)}return t},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),e.apply(this,arguments)}})}function vn(t){if(!t.RTCPeerConnection)return;const n=vt(t);if("chrome"===n.browser&&n.version>=71)return;const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(t){return t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")&&(t.sdp=t.sdp.split("\n").filter(t=>"a=extmap-allow-mixed"!==t.trim()).join("\n")),e.apply(this,arguments)}}const wn=Object.freeze({__proto__:null,shimRTCIceCandidate:dn,shimMaxMessageSize:hn,shimSendThrowTypeError:pn,shimConnectionState:mn,removeAllowExtmapMixed:vn});!function({window:t}={},n={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const e=pt,r=vt(t),i={browserDetails:r,commonShim:wn,extractVersion:ft,disableLog:dt,disableWarnings:ht};switch(r.browser){case"chrome":if(!xt||!kt||!n.shimChrome)return e("Chrome shim is not included in this adapter release."),i;e("adapter.js shimming chrome."),i.browserShim=xt,St(t),Et(t),kt(t),Ot(t),Pt(t),jt(t),Tt(t),It(t),Dt(t),dn(t),mn(t),hn(t),pn(t),vn(t);break;case"firefox":if(!nn||!qt||!n.shimFirefox)return e("Firefox shim is not included in this adapter release."),i;e("adapter.js shimming firefox."),i.browserShim=nn,Wt(t),qt(t),Bt(t),Xt(t),Ht(t),Kt(t),Qt(t),Yt(t),Zt(t),tn(t),dn(t),mn(t),hn(t),pn(t);break;case"edge":if(!Vt||!Jt||!n.shimEdge)return e("MS edge shim is not included in this adapter release."),i;e("adapter.js shimming edge."),i.browserShim=Vt,Ft(t),Gt(t),Jt(t),zt(t),hn(t),pn(t);break;case"safari":if(!ln||!n.shimSafari)return e("Safari shim is not included in this adapter release."),i;e("adapter.js shimming safari."),i.browserShim=ln,an(t),fn(t),on(t),en(t),rn(t),un(t),sn(t),dn(t),hn(t),pn(t),vn(t);break;default:e("Unsupported browser!")}}({window}),function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}();export{A as H,P as a,ot as b,st as c,ct as g,R as h,k as p,h as r};